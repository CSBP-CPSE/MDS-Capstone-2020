---
title: "socioecon_analysis"
author: "KT Hobbs"
date: "15/06/2020"
output: html_document
---

```{r libs}
library(skimr)
```

```{r read}
df = read.csv(file = 'econ_kt.csv', stringsAsFactors = FALSE, na.strings="", header=TRUE)
colnames(df)
```


```{r }
df2 = df[,-c(1, 2, 25, 52)]

# summary(df2)
 skim(df2)

```


```{r}
pc2 <- prcomp(df2)
summary(pc2)
```

```{r}
pc2$rotation[,1:2]
```
PC1: higher comorbidities, more detached homes, less amenity dense, higher age of population, less higher education, poorer mental and physical health

PC2: higher cost of living, high rises, more unemployment/less in the work force, perceived high stress, more commuting altogether and more vehical transit usage, percieved good health, much more amenity dense? => *possibly indicative of a city*

With commute time, all variables load onto one component.
```{r}
screeplot(pc2)
```

```{r}
library(dplyr)
cov <- read.csv('/Users/kt/Documents/UBC_MDS/capstone/data-599-capstone-statistics-canada/PHU_analysis/data/covid_wrangled.csv')

colnames(df)[2] <- "Reporting_PHU"


df$Reporting_PHU[df$Reporting_PHU=="The District of Algoma Health Unit"] <- "Algoma Public Health Unit"
df$Reporting_PHU[df$Reporting_PHU=="Durham Regional Health Unit"] <- "Durham Region Health Department"
df$Reporting_PHU[df$Reporting_PHU=="Halton Regional Health Unit"] <- "Halton Region Health Department"
df$Reporting_PHU[df$Reporting_PHU=="City of Toronto Health Unit"] <- "Toronto Public Health"
df$Reporting_PHU[df$Reporting_PHU=="City of Ottawa Health Unit"] <- "Ottawa Public Health"
df$Reporting_PHU[df$Reporting_PHU=="City of Hamilton Health Unit"] <- "Hamilton Public Health Services"
df$Reporting_PHU[df$Reporting_PHU=="The Eastern Ontario Health Unit"] <- "Eastern Ontario Health Unit"
df$Reporting_PHU[df$Reporting_PHU=="Halton Regional Health Unit"] <- "Halton RegionalHealth Department"
df$Reporting_PHU[df$Reporting_PHU=="Niagara Regional Area Health Unit"] <- "Niagara Region Public Health Department"
df$Reporting_PHU[df$Reporting_PHU=="Wellington-Dufferin-Guelph Health Unit"] <- "Wellington-Dufferin-Guelph Public Health"
df$Reporting_PHU[df$Reporting_PHU=="Peterborough County - City Health Unit"] <- "Peterborough Public Health"
df$Reporting_PHU[df$Reporting_PHU=="Peel Regional Health Unit"] <- "Peel Public Health Services"
df$Reporting_PHU[df$Reporting_PHU=="York Regional Public Health Services"] <- "York Region Public Health Services"

# duplicates
df$Reporting_PHU[df$Reporting_PHU=="Huron County Health Unit"] <- "Huron Perth District Health Unit"
df$Reporting_PHU[df$Reporting_PHU=="Perth District Health Unit"] <- "Huron Perth District Health Unit"
df$Reporting_PHU[df$Reporting_PHU=="Elgin-St. Thomas Health Unit"] <- "Southwestern Public Health"
df$Reporting_PHU[df$Reporting_PHU=="Oxford County Health Unit"] <- "Southwestern Public Health"


aggregate(df, by = list(df$Reporting_PHU), FUN = sum)


```



```{r}
head(cov)
head(df)

m <- merge(cov, df, by = intersect(names(cov), names(df)))
dim(m)
m

mutate(df2, cases = m$TOTAL)
suppressWarnings(biplot(pc2, xlabs = df$Location_x))
```

